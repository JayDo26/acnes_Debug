import r from'./../../../../external/@swc/helpers/src/_async_to_generator.mjs.js';import e from'./../../../../external/@swc/helpers/src/_object_spread.mjs.js';import t from"../../../token.js";import s from"../../../../utils/query-string.js";import{apiResponse as a}from"../../../../utils/response.js";import{PAYMENT_APIS as o,APP_ID as n}from"../../../../constants.js";import i from"../getRouteParams.js";import{__generator as m}from'./../../../../external/tslib/tslib.es6.js';var c,p=(c=r((function(r){var c,p,d,u,f,g,h,j,l,b,y;return m(this,(function(m){switch(m.label){case 0:return p="",r||(r=i()),"object"==typeof r&&((p=r.zmpOrderId||"")||(c=r.appTransID||r.orderId||r.apptransid)),"string"==typeof r&&(d=s.getParameterByName("orderId",r),u=s.getParameterByName("appTransID",r)||s.getParameterByName("apptransid",r),c=d||u),f={headers:{authorization:"Bearer "}},[4,t.getAccessToken().catch((function(){throw a.error.loginRequired}))];case 1:return g=m.sent(),f.headers.authorization="Bearer ".concat(g),h=new URL(o.GET_TRANSACTION),j={orderId:p,transId:c||"",appId:n},h.search=new URLSearchParams(j).toString(),[4,fetch(h.toString(),f)];case 2:return[4,m.sent().json()];case 3:if(!(l=m.sent()).data)throw a.error.badRequest(l.msg);return b=l.data||{},y={err:l.err},0!==Object.keys(b).length&&b.constructor===Object&&Object.assign(y,e({msg:b.resultMessage},b)),[2,y]}}))})),function(r){return c.apply(this,arguments)});export{p as default};
